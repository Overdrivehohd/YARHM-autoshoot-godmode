if not game:IsLoaded() then game.Loaded:Wait() end
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
RAW_URL = "https://raw.githubusercontent.com/Overdrivehohd/key.txt/refs/heads/main/OHIO?t=" .. tick()
KeyEntered = false
function GetKeyData() local s, r = pcall(function() return game:HttpGet(RAW_URL) end) if s then local ds, d = pcall(function() return HttpService:JSONDecode(r) end) return ds and d or nil end return nil end
local ksg = Instance.new("ScreenGui", game:GetService("CoreGui")) local kmain = Instance.new("Frame", ksg); kmain.Size = UDim2.new(0, 300, 0, 180); kmain.Position = UDim2.new(0.5, -150, 0.5, -90); kmain.BackgroundColor3 = Color3.fromRGB(20, 20, 25); kmain.Active = true; Instance.new("UICorner", kmain) local kstroke = Instance.new("UIStroke", kmain); kstroke.Thickness = 2; kstroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border local ktitle = Instance.new("TextLabel", kmain); ktitle.Size = UDim2.new(1, 0, 0, 60); ktitle.Text = "Welcome, " .. player.DisplayName; ktitle.Font = "GothamBold"; ktitle.BackgroundTransparency = 1; KeyInput = Instance.new("TextBox", kmain); KeyInput.Size = UDim2.new(0.8, 0, 0, 35); KeyInput.Position = UDim2.new(0.1, 0, 0.4, 0); KeyInput.PlaceholderText = "ENTER KEY..."; KeyInput.BackgroundColor3 = Color3.fromRGB(30, 30, 35); KeyInput.TextColor3 = Color3.new(1,1,1); Instance.new("UICorner", KeyInput) local lbtn = Instance.new("TextButton", kmain); lbtn.Size = UDim2.new(0.8, 0, 0, 35); lbtn.Position = UDim2.new(0.1, 0, 0.68, 0); lbtn.Text = "LOGIN"; lbtn.BackgroundColor3 = Color3.fromRGB(0, 120, 255); lbtn.TextColor3 = Color3.new(1,1,1); lbtn.Font = "GothamBold"; Instance.new("UICorner", lbtn)
lbtn.MouseButton1Click:Connect(function() local k = GetKeyData() if k and k[KeyInput.Text] then KeyEntered = true; ksg:Destroy() else player:Kick("Buy a new key jew!💀") end end) repeat task.wait() until KeyEntered == true
local DT = "NzMxNzE0MjUxODEwNTM3NTAz.GWZFKr.tk2A3_tRAYfGLGKJt6AhNrRx6ZubuyZXnTHb_M"
local CI = "1426479580784361482"
local SETTINGS = "SkiddedSettings.json" ScannerOn, AutoOn, MinV, TotalF, BL, WL, LJID, LogH = false, false, 0, 0, {}, {}, nil, {}
function Save() local d = HttpService:JSONEncode({Priority = WL, Blacklist = BL, MinVal = MinV}) if writefile then writefile(SETTINGS, d) end end
function Load() if isfile and isfile(SETTINGS) then local s, c = pcall(function() return readfile(SETTINGS) end) if s then local d = HttpService:JSONDecode(c) WL, BL, MinV = d.Priority or {}, d.Blacklist or {}, d.MinVal or 0 end end end end Load()
local sg = Instance.new("ScreenGui", player:WaitForChild("PlayerGui")); task.wait(0.5); print("Scanner Loaded")